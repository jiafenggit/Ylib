<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "DTD/xhtml1-strict.dtd">
<html>
<body bgcolor="#ffffff">
<font size="-1">/&nbsp;ylog.h&nbsp;/&nbsp;Content</font>
<pre>/* Process this file with the HeaderBrowser tool (http://www.headerbrowser.org)
   to create documentation. */

#ifndef __YLOG_H__
#define __YLOG_H__


#define YLOG(...)		ylog_add(YLOG_FORCE, __FILE__, __LINE__, 
					 __func__, __VA_ARGS__)

#define YLOG_ADD(prio, ...)	ylog_add(prio, __FILE__, __LINE__, 
					 __func__, __VA_ARGS__)


enum ylog_type_e {
	YLOG_STDERR	= 1,
	YLOG_FILE	= 2,
	YLOG_SYSLOG	= 4,
	YLOG_HANDLER	= 8
};


typedef enum ylog_type_e ylog_type_t;


enum ylog_priority_e {
	YLOG_FORCE = -1,
	YLOG_DEBUG = 0,
	YLOG_INFO,
	YLOG_NOTE,
	YLOG_WARN,
	YLOG_ERR,
	YLOG_CRIT
};


typedef enum ylog_priority_e ylog_priority_t;

/**
 * @typedef ylog_handler_t
 * Function pointer used for ylog handlers.
 * @param	str	Log string.
 */
typedef void (*ylog_handler_t)(const char *str);


struct ylog_s {
	ylog_priority_t threshold;
	char *progname;
	char *filename;
	void (*handler)(const char*);
	int setup;
	int facility;
};


typedef struct ylog_s ylog_t;

/**
 * @function	ylog_init
 *		Initialize the logging system.
 * @param	setup		Log type. Boolean comination of ylog_type_t values.
 * @param	progname	Name of the current process.
 * @param	...		List of other parameters, in this order:
 *				- Path to the log file.
 *				- Pointer to an handler function.
 */
void ylog_init(unsigned int setup, const char *progname, ...);

/**
 * @function	ylog_threshold
 *		Change the minimum priority level. Only messages with a greater or
 *		equal level will be written into logs.
 * @param	threshold	New default priority threashold.
 */
void ylog_threshold(ylog_priority_t threshold);

/**
 * @function	ylog_add
 *		Write a new log entry.
 * @param	prio	Priority level.
 * @param	file	Name of the file where this log entry is added.
 * @param	line	Number of the line where this log entry is added.
 * @param	func	Caller function's name.
 * @param	str	Main character string of the message.
 * @param	...	Variable arguments.
 */
void ylog_add(ylog_priority_t prio, const char *file, int line,
              const char *funcname, const char *str, ...);

#endif // __YLOG_H__
</pre>
</body>
</html>